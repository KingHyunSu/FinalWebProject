<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ClientBoard">
	<select id="selectTotalRowNum" resultType="int">
		select count(*) from mail
	</select>
	<select id="selectMailList" parameterType="map" resultType="com.postoffice.web.dto.MailDTO">
	select rn,mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date	
		from(
		    select rownum as rn, mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date
		    from(
		        select mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date	
		        from Mail
		    )
		    where rownum &lt;= #{endRowNo}
		)
		where rn &gt; = #{startRowNo}
	</select>
	
	<select id="selectnum" resultType="int">
		select count(*) from Mail 
	</select>
	
	<insert id="insertBoard" parameterType="com.postoffice.web.dto.MailDTO">
		insert into Mail(mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date)
			values(seq_mail.nextval,#{from_name},#{from_address},#{to_name},#{to_address},#{mail_weight},'s001',sysdate)
	</insert>
	
	<delete id="removeRequest">
		delete Mail where mail_id = #{mail_id}
	</delete>
	
	<select id="selectOne" parameterType="int" resultType="com.postoffice.web.dto.MailDTO">
		select mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date from mail
		where mail_id=#{mail_id}
	</select>
	
	<update id="updateOne" parameterType="com.postoffice.web.dto.MailDTO">
		update mail set mail_id=#{mail_id}
		,from_name=#{from_name}
		,from_address=#{from_address}
		,to_name=#{to_name}
		,to_address=#{to_address}
		,mail_weight=#{mail_weight}
		,state_id=#{state_id}
		where mail_id = #{mail_id}
	</update>
	
	<select id="selectsearch" parameterType="map" resultType="com.postoffice.web.dto.MailDTO">		
		select rn,mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_id	
		from(
		    select rownum as rn, mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id	,mail_date
		    from(
		        SELECT
					*
				FROM
					mail
				WHERE
					from_name
				LIKE
					#{keyword}
		    )
		    where rownum &lt;= #{endRowNo}
		)
		where rn &gt; = #{startRowNo}
	</select>
	
	<select id="toselectsearch" parameterType="map" resultType="com.postoffice.web.dto.MailDTO">		
		select rn,mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date	
		from(
		    select rownum as rn, mail_id,from_name,from_address,to_name,to_address,mail_weight,state_id,mail_date
		    from(
		        SELECT
					*
				FROM
					mail
				WHERE
					to_name
				LIKE
					#{keyword}
		    )
		    where rownum &lt;= #{endRowNo}
		)
		where rn &gt; = #{startRowNo}
	</select>
</mapper>